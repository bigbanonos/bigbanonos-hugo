{{/* layouts/shortcodes/spotify.html - click-to-load */}}

{{ $raw := "" }}
{{ if .IsNamedParams }}
  {{ $raw = (.Get "url") | default (.Get "id") | default "" }}
{{ else }}
  {{ $raw = (.Get 0) | default "" }}
{{ end }}

{{ $title := (.Get "title") | default "Play on Spotify" }}
{{ $type := (.Get "type") | default "track" }}
{{ $id := $raw }}

{{ if (in $raw "open.spotify.com/") }}
  {{ $m := findRE `open\.spotify\.com/(track|album|playlist)/([A-Za-z0-9]+)` $raw }}
  {{ if gt (len $m) 0 }}
    {{ $pair := index $m 0 }}
    {{ $type = replaceRE `.*open\.spotify\.com/(track|album|playlist)/([A-Za-z0-9]+).*` `$1` $pair }}
    {{ $id = replaceRE `.*open\.spotify\.com/(track|album|playlist)/([A-Za-z0-9]+).*` `$2` $pair }}
  {{ end }}
{{ end }}

<div class="bb-spotify-lite"
     data-spotify-type="{{ $type }}"
     data-spotify-id="{{ $id }}"
     role="button"
     tabindex="0"
     aria-label="{{ $title }}"
     style="cursor:pointer;border:1px solid rgba(0,0,0,.15);padding:.75rem;border-radius:.75rem;max-width:700px;">
  â–¶ {{ $title }}
</div>
